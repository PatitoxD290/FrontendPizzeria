<!-- BOTÓN FLOTANTE DEL CARRITO - SOLO SE MUESTRA EN MENU -->
<button mat-fab color="primary" class="boton-carrito" (click)="toggleCarrito()" 
        *ngIf="!esPaginaPago() && !esPaginaCarrito"
        [class.boton-bloqueado]="modalAbierto"
        [attr.disabled]="modalAbierto ? true : null">
  <mat-icon class="icono-carrito">shopping_bag</mat-icon>
  <span class="texto-carrito">Ver Pedido</span>
  <span class="badge-icon" *ngIf="cantidadItemsDistintos > 0">
    {{ cantidadItemsDistintos }}
  </span>
</button>

<!-- CONTENIDO DE PÁGINA COMPLETA - SOLO CUANDO ES RUTA /carrito -->
<div *ngIf="esPaginaCarrito" class="pagina-carrito-completa">
  <!-- ENCABEZADO DE PÁGINA -->
  <div class="encabezado-pagina">
    <button mat-button (click)="volver()" class="btn-volver">
      <mat-icon>arrow_back</mat-icon>
      <span class="texto-volver">Volver al Menú</span>
    </button>
  </div>

  <!-- CONTENIDO PRINCIPAL -->
  <div class="contenido-pagina">
    <!-- LISTA DE PRODUCTOS -->
    <div class="lista-productos-pagina" *ngIf="carritoService.obtenerProductos().length > 0; else vacio">
      <div *ngFor="let item of carritoService.obtenerProductos(); let i = index" class="item-carrito-pagina">
        <img [src]="item.imagen" alt="{{ item.nombre }}" class="imagen-item" />
        <div class="info-pagina">
          <p class="nombre-pagina">{{ item.nombre }}</p>
          <p class="descripcion-pagina">{{ item.descripcion }}</p>
          <p class="tamano-pagina" *ngIf="item.nombre_tamano">
            <b>Tamaño:</b> {{ item.nombre_tamano | uppercase }}
          </p>
          <p class="precio-pagina">
            S/. {{ item.precio | number:'1.2-2' }} c/u
          </p>
          <div class="controles-pagina">
            <div class="cantidad-control-pagina">
              <button mat-mini-fab color="warn" (click)="decrementarCantidad(i)">
                <mat-icon>remove</mat-icon>
              </button>
              <span class="cantidad-text-pagina">{{ item.cantidad }}</span>
              <button mat-mini-fab color="primary" (click)="incrementarCantidad(i)">
                <mat-icon>add</mat-icon>
              </button>
            </div>
            <button mat-icon-button color="warn" class="btn-eliminar-pagina" (click)="eliminarProducto(i)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
          <p class="subtotal-pagina">
            <strong>Subtotal: S/. {{ item.subtotal | number:'1.2-2' }}</strong>
          </p>
        </div>
      </div>
    </div>

    <!-- CARRITO VACÍO -->
    <ng-template #vacio>
      <div class="carrito-vacio-pagina">
        <mat-icon class="icono-vacio">shopping_bag</mat-icon>
        <h2>Tu pedido está vacío</h2>
        <p>Agrega productos desde el menú</p>
        <!-- En la sección de carrito vacío -->
        <button mat-flat-button color="primary" (click)="volver()" class="btn-volver-menu">
          <mat-icon>arrow_back</mat-icon>
          Volver al Menú
        </button>
      </div>
    </ng-template>

    <!-- RESUMEN Y BOTONES - SOLO SI HAY PRODUCTOS -->
    <div *ngIf="carritoService.obtenerProductos().length > 0" class="resumen-pagina">
      <div class="total-pagina">
        <span class="total-texto">Total del Pedido:</span>
        <span class="total-monto">S/. {{ total.toFixed(2) }}</span>
      </div>
      
      <div class="botones-pagina">
        <button mat-stroked-button color="warn" (click)="vaciarCarrito()" class="btn-vaciar">
          Vaciar Carrito
        </button>
        <button mat-flat-button color="primary" (click)="confirmarPedido()" class="btn-confirmar">
          Confirmar Pedido
        </button>
      </div>
    </div>
  </div>
</div>