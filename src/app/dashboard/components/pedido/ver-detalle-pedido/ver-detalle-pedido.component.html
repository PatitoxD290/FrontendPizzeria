<div class="dialog-container">
  
  <!-- Header -->
  <div class="dialog-header">
    <h2 mat-dialog-title class="m-0 d-flex align-items-center">
      <mat-icon class="me-2 text-primary">receipt_long</mat-icon>
      Pedido #{{ data.pedido_id }}
    </h2>
    <button mat-icon-button (click)="close()">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <mat-dialog-content class="dialog-content">
    
    <!-- Loading -->
    <div *ngIf="loading" class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p class="mt-3 text-secondary">Cargando información...</p>
    </div>

    <!-- Error -->
    <div *ngIf="!loading && error" class="error-state">
      <mat-icon color="warn" class="large-icon">error_outline</mat-icon>
      <p>{{ error }}</p>
    </div>

    <!-- Contenido -->
    <div *ngIf="!loading && !error">
      
      <!-- Notas -->
      <div *ngIf="notas" class="notes-section">
        <h4 class="section-title">
          <mat-icon class="icon-small">comment</mat-icon> Notas
        </h4>
        <p class="notes-text">{{ notas }}</p>
      </div>

      <mat-divider *ngIf="notas" class="my-3"></mat-divider>

      <!-- Lista de Productos -->
      <h4 class="section-title mb-2">
        <mat-icon class="icon-small">list</mat-icon> Detalle de Productos
      </h4>

      <div class="items-list">
        <div *ngFor="let d of detalles" class="item-row">
          
          <!-- Cantidad -->
          <div class="item-qty">
            {{ d.Cantidad }}x
          </div>

          <!-- Descripción -->
          <div class="item-desc">
            <div class="item-name">
              {{ getItemName(d) }}
              <span *ngIf="isCombo(d)" class="combo-badge">Combo</span>
            </div>
            <div class="item-meta text-muted small">
              {{ getItemDetail(d) }}
            </div>
          </div>

          <!-- Precio -->
          <div class="item-price">
            S/ {{ d.PrecioTotal | number:'1.2-2' }}
          </div>

        </div>
      </div>

      <div *ngIf="detalles.length === 0" class="empty-state">
        No hay detalles disponibles.
      </div>

      <mat-divider class="my-3"></mat-divider>

      <!-- Total -->
      <div class="total-section">
        <span class="total-label">TOTAL</span>
        <span class="total-amount">S/ {{ getTotal() | number:'1.2-2' }}</span>
      </div>

    </div>

  </mat-dialog-content>

  <mat-dialog-actions align="end" class="dialog-actions">
    <button mat-stroked-button color="primary" (click)="close()">Cerrar</button>
  </mat-dialog-actions>
</div>