<div class="menu-container">
  <!-- 游 Loading -->
  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
  </div>

  <!-- 游 Lista de productos - AHORA MUESTRA PRODUCTOS CON RANGO DE PRECIOS -->
  <div *ngIf="!loading" class="productos-grid">
    <div
      *ngFor="let p of paginatedItems"
      class="producto-card"
      (click)="abrirPersonalizacion(p)"
      style="cursor: pointer"
    >
      <div class="producto-imagen-container">
        <img
          [src]="p.imagen"
          (error)="onImageError($event)"
          [alt]="p.Nombre"
          class="producto-imagen"
        />
      </div>
      <div class="producto-info">

        <!-- 游댳 CONTENEDOR PARA CATEGOR칈A Y BADGES EN LA MISMA L칈NEA -->
        <div class="categoria-badges-container">
          <!-- Categor칤a a la izquierda -->
          <div class="meta-item categoria-item" *ngIf="!p.esCombo">
            <span class="meta-value">{{ p.nombre_categoria }}</span>
          </div>

          <!-- Badges a la derecha -->
          <div class="badges-right">
            <!-- 游댳 Indicador de combo -->
            <div *ngIf="p.esCombo" class="combo-badge meta-badge">
              <img src="/assets/icons/ic-combo.png" alt="Combo" class="badge-icon">
              Combo
            </div>

            <!-- 游댳 Indicador de tama침os disponibles -->
            <div *ngIf="!p.esCombo && p.tamanos && p.tamanos.length > 1" class="tamanos-badge meta-badge">
              <img src="/assets/icons/ic-regla.png" alt="Tama침os" class="badge-icon">
              {{ p.tamanos.length }} Tama침os
            </div>
          </div>
        </div>

        <h3 class="producto-nombre">{{ p.Nombre }}</h3>

        <!-- 游댳 Mostrar detalles de combo DEBAJO de la descripci칩n -->
        <div *ngIf="p.esCombo && p.detallesTexto" class="producto-detalles">
          {{ p.detallesTexto }}
        </div>

        <p class="producto-descripcion">{{ p.Descripcion }}</p>

        <!-- 游댳 INFORMACI칍N COMPLETA EN ORDEN VERTICAL -->
        <div class="producto-meta-info">
          <!-- Precio - "Desde" para productos con m칰ltiples tama침os -->
          <div class="meta-item precio-item">
            <span class="meta-value precio">
              <span *ngIf="!p.esCombo && (p.tamanos?.length || 0) > 1" class="desde-label"
                >Precio Desde
              </span>
              {{ obtenerRangoPrecios(p) }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mensaje cuando no hay resultados -->
  <div *ngIf="!loading && paginatedItems.length === 0" class="no-results">
    <mat-icon>search_off</mat-icon>
    <p>No se encontraron productos o combos</p>
    <button mat-button color="primary" (click)="limpiarBusqueda()">Ver todo el men칰</button>
  </div>

  <!-- Paginador -->
  <mat-paginator
    [length]="productosFiltrados.length" 
    [pageSize]="pageSize" 
    [pageSizeOptions]="[8, 12, 16, 24]" 
    (page)="onPageChange($event)"
    [hidden]="productosFiltrados.length === 0">
  </mat-paginator>

</div>