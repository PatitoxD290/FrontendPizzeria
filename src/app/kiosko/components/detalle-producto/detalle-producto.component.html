<div class="detalle-container">
  
  <!-- Header / Imagen -->
  <div class="image-header">
    <img [src]="imagen" [alt]="nombre" (error)="onImageError($event)">
    <button mat-icon-button class="close-btn" (click)="cerrar()">
      <mat-icon>close</mat-icon>
    </button>
    
    <div class="badges">
      <span class="badge-combo" *ngIf="esCombo">COMBO</span>
      <span class="badge-stock" *ngIf="!esCombo && data.Cantidad_Disponible > 0">En Stock</span>
    </div>
  </div>

  <div class="content-body">
    
    <!-- Título y Descripción -->
    <div class="header-info">
      <h2 class="product-title">{{ nombre }}</h2>
      <p class="product-desc">{{ descripcion || 'Sin descripción disponible.' }}</p>
    </div>

    <!-- Selección de Tamaño (Solo Productos) -->
    <div class="section" *ngIf="!esCombo && tamanosDisponibles.length > 0">
      <h4 class="section-title">Elige un tamaño</h4>
      <div class="tamanos-grid">
        <button 
          *ngFor="let t of tamanosDisponibles" 
          class="tamano-btn" 
          [class.selected]="tamanoSeleccionado?.ID_Producto_T === t.ID_Producto_T"
          (click)="seleccionarTamano(t)">
          <span class="t-name">{{ t.nombre_tamano }}</span>
          <span class="t-price">S/ {{ t.Precio | number:'1.2-2' }}</span>
        </button>
      </div>
    </div>

    <!-- Sección Complementos (Bebidas) -->
    <!-- Se muestra si es combo O si es producto que no es bebida -->
    <div class="section" *ngIf="esCombo || !esBebida">
      <div class="complementos-box" (click)="abrirComplementos()">
        <div class="comp-info">
          <mat-icon class="comp-icon">local_drink</mat-icon>
          <div class="comp-text">
            <span class="comp-title">¿Deseas agregar bebidas?</span>
            <span class="comp-subtitle" *ngIf="!tieneComplementos">Toca para seleccionar</span>
            <span class="comp-selected" *ngIf="tieneComplementos">
              {{ cantidadComplementos }} seleccionados
            </span>
          </div>
        </div>
        <mat-icon class="chevron">chevron_right</mat-icon>
      </div>
    </div>

    <!-- Cantidad y Precio -->
    <div class="price-qty-section">
      <div class="qty-control">
        <button mat-icon-button (click)="decrementar()" [disabled]="cantidad <= 1">
          <mat-icon>remove</mat-icon>
        </button>
        <span class="qty-value">{{ cantidad }}</span>
        <button mat-icon-button (click)="incrementar()">
          <mat-icon>add</mat-icon>
        </button>
      </div>
      
      <div class="total-display">
        <span class="label">Total</span>
        <span class="amount">S/ {{ (precioBase * cantidad) | number:'1.2-2' }}</span>
      </div>
    </div>

  </div>

  <!-- Footer Actions -->
  <div class="actions-footer">
    <button mat-stroked-button class="btn-cancel" (click)="cerrar()">
      Cancelar
    </button>
    <button mat-flat-button color="primary" class="btn-add" 
            (click)="agregarAlCarrito()" 
            [disabled]="!esCombo && !tamanoSeleccionado">
      <mat-icon>add_shopping_cart</mat-icon>
      Agregar al Pedido
    </button>
  </div>
</div>