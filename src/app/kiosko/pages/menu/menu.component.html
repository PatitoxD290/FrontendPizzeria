<<<<<<< HEAD
<div class="kiosko-container">
  
  <!-- üîç Barra Superior -->
  <div class="search-header">
    <div class="search-box mat-elevation-z2">
      <mat-icon class="search-icon">search</mat-icon>
      <input 
        type="text" 
        placeholder="¬øQu√© se te antoja hoy?" 
        [(ngModel)]="terminoBusqueda" 
        (keyup)="aplicarFiltros()">
      <button *ngIf="terminoBusqueda" mat-icon-button (click)="limpiarBusqueda()">
        <mat-icon>close</mat-icon>
      </button>
=======
<div class="menu-container">
  <!-- üßæ Lista de productos - AHORA MUESTRA PRODUCTOS CON RANGO DE PRECIOS -->
  <div class="productos-grid">
    <div
      *ngFor="let p of productosFiltrados"
      class="producto-card"
      (click)="abrirPersonalizacion(p)"
      style="cursor: pointer"
    >
      <div class="producto-imagen-container">
        <img
          [src]="p.imagen"
          (error)="p.imagen = '/assets/imgs/logo.png'"
          [alt]="p.Nombre"
          class="producto-imagen"
        />
      </div>
      <div class="producto-info">

        <!-- üîπ CONTENEDOR PARA CATEGOR√çA Y BADGES EN LA MISMA L√çNEA -->
        <div class="categoria-badges-container">
          <!-- Categor√≠a a la izquierda -->
          <div class="meta-item categoria-item" *ngIf="!p.esCombo">
            <span class="meta-value">{{ p.nombre_categoria }}</span>
          </div>

          <!-- Badges a la derecha -->
          <div class="badges-right">
            <!-- üîπ Indicador de combo -->
            <div *ngIf="p.esCombo" class="combo-badge meta-badge">
              <img src="/assets/icons/ic-combo.png" alt="Combo" class="badge-icon">
              Combo
            </div>

            <!-- üîπ Indicador de tama√±os disponibles -->
            <div *ngIf="!p.esCombo && p.tamanos && p.tamanos.length > 1" class="tamanos-badge meta-badge">
              <img src="/assets/icons/ic-regla.png" alt="Tama√±os" class="badge-icon">
              {{ p.tamanos.length }} Tama√±os
            </div>
          </div>
        </div>

        <h3 class="producto-nombre">{{ p.Nombre }}</h3>

        <!-- üîπ Mostrar detalles de combo DEBAJO de la descripci√≥n -->
        <div *ngIf="p.esCombo && p.detallesTexto" class="producto-detalles">
          {{ p.detallesTexto }}
        </div>

        <p class="producto-descripcion">{{ p.Descripcion }}</p>

        <!-- üîπ INFORMACI√ìN COMPLETA EN ORDEN VERTICAL -->
        <div class="producto-meta-info">
          <!-- Precio - "Desde" para productos con m√∫ltiples tama√±os -->
          <div class="meta-item precio-item">
            <span class="meta-value precio">
              <span *ngIf="!p.esCombo && (p.tamanos?.length || 0) > 1" class="desde-label"
                >Precio Desde
              </span>
              {{ obtenerRangoPrecios(p) }}
            </span>
          </div>
        </div>
      </div>
>>>>>>> 71628ab0a6a7f3d7dbb4c222b0490f1c7f17032c
    </div>
  </div>

  <!-- üè∑Ô∏è Categor√≠as (Horizontal Scroll) -->
  <div class="categories-bar">
    <mat-chip-listbox>
      <mat-chip-option 
        [selected]="categoriaSeleccionada === null" 
        (click)="filtrarPorCategoria(null)"
        color="accent">
        Todo
      </mat-chip-option>
      
      <mat-chip-option 
        [selected]="categoriaSeleccionada === 999" 
        (click)="filtrarPorCategoria(999)"
        color="warn">
        üî• Combos
      </mat-chip-option>

      <mat-chip-option 
        *ngFor="let cat of categorias" 
        [selected]="categoriaSeleccionada === cat.ID_Categoria_P"
        (click)="filtrarPorCategoria(cat.ID_Categoria_P)"
        color="primary">
        {{ cat.Nombre }}
      </mat-chip-option>
    </mat-chip-listbox>
  </div>

  <!-- üåÄ Loading -->
  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="60" color="accent"></mat-spinner>
    <p>Preparando el men√∫...</p>
  </div>

  <!-- üì¶ Grid de Productos -->
  <div *ngIf="!loading" class="menu-content" id="menu-grid">
    
    <div class="products-grid">
      <mat-card *ngFor="let item of paginatedItems" 
                class="menu-card" 
                (click)="abrirDetalle(item)">
        
        <!-- Imagen -->
        <div class="card-image">
          <!-- üñºÔ∏è Aqu√≠ se aplica la imagen cargada din√°micamente -->
          <img [src]="item.imagen" [alt]="item.nombre" (error)="onImageError($event)">
          
          <!-- Badge Combo -->
          <div class="combo-badge" *ngIf="item.tipo === 'combo'">
            <mat-icon>local_offer</mat-icon> COMBO
          </div>

          <!-- Badge Agotado -->
          <div class="agotado-overlay" *ngIf="item.tipo === 'producto' && item.stock === 0">
             <span>AGOTADO</span>
          </div>
          
          <!-- Overlay Click -->
          <div class="card-overlay" *ngIf="item.stock > 0">
            <span>Seleccionar</span>
          </div>
        </div>

        <!-- Contenido -->
        <mat-card-content class="card-content">
          <h3 class="product-title">{{ item.nombre }}</h3>
          <p class="product-desc">{{ item.descripcion }}</p>
          
          <div class="card-footer">
            <span class="price">{{ item.precioDisplay }}</span>
            <button mat-mini-fab color="primary" class="add-btn" [disabled]="item.stock === 0">
              <mat-icon>add</mat-icon>
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Empty State -->
    <div *ngIf="paginatedItems.length === 0" class="no-results">
      <mat-icon>restaurant_menu</mat-icon>
      <h3>No encontramos lo que buscas</h3>
      <button mat-button color="primary" (click)="limpiarBusqueda()">Ver todo el men√∫</button>
    </div>

  </div>

  <!-- üìÑ Paginador -->
  <mat-paginator 
    [length]="filteredItems.length"
    [pageSize]="pageSize"
    [pageSizeOptions]="pageSizeOptions"
    (page)="onPageChange($event)"
    [hidden]="filteredItems.length === 0"
    class="custom-paginator">
  </mat-paginator>

</div>