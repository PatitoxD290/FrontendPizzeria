<div class="menu-container">
  
  <!-- ðŸ” Barra de BÃºsqueda -->
  <div class="search-section">
    <div class="search-box">
      <mat-icon>search</mat-icon>
      <input 
        type="text" 
        placeholder="Â¿QuÃ© desea ordenar hoy?" 
        [(ngModel)]="terminoBusqueda" 
        (keyup)="buscarProducto()">
      <button *ngIf="terminoBusqueda" mat-icon-button (click)="terminoBusqueda=''; buscarProducto()">
        <mat-icon>close</mat-icon>
      </button>
    </div>
  </div>

  <!-- ðŸ·ï¸ CategorÃ­as (Scroll Horizontal) -->
  <div class="categories-scroll">
    <mat-chip-listbox class="mat-mdc-chip-set-stacked">
      <mat-chip-option 
        [selected]="categoriaSeleccionada === null" 
        (click)="filtrarPorCategoria(null)"
        color="accent">
        Todos
      </mat-chip-option>
      <mat-chip-option 
        *ngFor="let cat of categorias" 
        [selected]="categoriaSeleccionada === cat.ID_Categoria_P"
        (click)="filtrarPorCategoria(cat.ID_Categoria_P)"
        color="primary">
        {{ cat.Nombre }}
      </mat-chip-option>
    </mat-chip-listbox>
  </div>

  <!-- ðŸŒ€ Loading -->
  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
  </div>

  <!-- ðŸ“¦ Grid de Productos -->
  <div *ngIf="!loading" class="products-grid" id="menu-grid">
    
    <mat-card 
      *ngFor="let producto of paginatedProductos" 
      class="product-card" 
      (click)="seleccionarProducto(producto)"
      [class.disabled]="producto.Cantidad_Disponible === 0">
      
      <div class="card-image">
        <img [src]="getProductoImage(producto)" [alt]="producto.Nombre" (error)="onImageError($event)">
        <div class="stock-badge" *ngIf="producto.Cantidad_Disponible > 0 && producto.Cantidad_Disponible <= 5">
          Â¡Quedan {{producto.Cantidad_Disponible}}!
        </div>
        <div class="agotado-overlay" *ngIf="producto.Cantidad_Disponible === 0">
          <span>AGOTADO</span>
        </div>
      </div>

      <mat-card-content class="card-content">
        <h3 class="product-title">{{ producto.Nombre }}</h3>
        <p class="product-category">{{ producto.nombre_categoria }}</p>
        
        <div class="product-footer">
          <span class="price-tag">{{ getPrecioDisplay(producto) }}</span>
          <span class="size-tag">{{ getInfoTamanos(producto) }}</span>
        </div>
      </mat-card-content>

      <div class="card-action-overlay">
        <button mat-mini-fab color="accent">
          <mat-icon>add</mat-icon>
        </button>
      </div>
    </mat-card>

    <!-- Empty State -->
    <div *ngIf="paginatedProductos.length === 0" class="no-results">
      <mat-icon>search_off</mat-icon>
      <p>No encontramos productos con esa bÃºsqueda.</p>
      <button mat-button color="primary" (click)="filtrarPorCategoria(null); terminoBusqueda=''">Ver todo el menÃº</button>
    </div>

  </div>

  <!-- ðŸ“„ PaginaciÃ³n -->
  <mat-paginator 
    [length]="productosFiltrados.length"
    [pageSize]="pageSize"
    [pageSizeOptions]="pageSizeOptions"
    (page)="onPageChange($event)"
    [hidden]="productosFiltrados.length === 0"
    class="custom-paginator">
  </mat-paginator>

</div>