<!-- BOTÓN FLOTANTE DEL CARRITO -->
<button mat-fab color="primary" class="boton-carrito" (click)="toggleCarrito()" *ngIf="!visible && !esPaginaPago()">
  <mat-icon class="icono-carrito">shopping_bag</mat-icon>
  <span class="texto-carrito">Ver Pedido</span>
  <span class="badge-icon" *ngIf="cantidadItemsDistintos > 0">
    {{ cantidadItemsDistintos }}
  </span>
</button>


<!-- PANEL LATERAL DEL CARRITO -->
<div class="panel-carrito" [class.abierto]="visible && !esPaginaPago()">
  <!-- ENCABEZADO -->
  <div class="panel-header">
    <div class="titulo-carrito">
      <mat-icon class="icono-header-carrito">shopping_bag</mat-icon>
      <h3>Tu Pedido</h3>
    </div>
    <button mat-icon-button (click)="volver()" class="btn-cerrar">
      <mat-icon>close</mat-icon>
    </button>
  </div>


  <!-- LISTA DE PRODUCTOS -->
  <div class="lista-productos" *ngIf="carritoService.obtenerProductos().length > 0; else vacio">
    <div *ngFor="let item of carritoService.obtenerProductos(); let i = index" class="item-carrito">
      <img [src]="item.imagen" alt="{{ item.nombre }}" />

      <div class="info">
        <p class="nombre">{{ item.nombre }}</p>
        <p class="descripcion">{{item.descripcion }}</p>
        <p clsss="tamano" *ngIf="item.tamano"><b>Tamaño:</b> {{ item.tamano | uppercase }}</p>
        <p class="precio"> subtotal S/. {{ (item.precio * item.cantidad) | number:'1.2-2' }}</p>
        <div class="cantidad-control">
          <button mat-mini-fab color="warn" (click)="decrementarCantidad(i)">
            <mat-icon>remove</mat-icon>
          </button>
          <span class="cantidad-text">{{ item.cantidad }}</span>
          <button mat-mini-fab color="primary" (click)="incrementarCantidad(i)">
            <mat-icon>add</mat-icon>
          </button>
        </div>
      </div>

      <button mat-icon-button color="warn" class="btn-eliminar" (click)="eliminarProducto(i)">
        <mat-icon>delete</mat-icon>
      </button>
    </div>
  </div>

  <!-- CARRITO VACÍO -->
  <ng-template #vacio>
    <div class="carrito-vacio">
      <p>Tu pedido está vacío</p>
    </div>
  </ng-template>

  <!-- SUBTOTAL -->
  <div class="resumen" *ngIf="carritoService.obtenerProductos().length > 0">
    <div class="resumen-total">
      <span>Subtotal:</span>
      <strong>S/. {{ total.toFixed(2) }}</strong>
    </div>
  </div>

  <!-- BOTONES ABAJO -->
  <div class="acciones-fijas" *ngIf="carritoService.obtenerProductos().length > 0">
    <button mat-stroked-button class="volver" (click)="volver()">Volver</button>
    <button mat-flat-button class="confirmar-pedido" (click)="confirmarPedido()">
      Confirmar Pedido
    </button>
  </div>
</div>
