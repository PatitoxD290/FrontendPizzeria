<!-- Header del pedido -->
<div class="pedido-header">
  <h3>Resumen del Pedido</h3>
  <span class="codigo-badge">{{ codigoPedido }}</span>
</div>

<!-- üîπ Cards de productos y combos -->
<div class="cards-container">
  <div class="product-card" 
       *ngFor="let d of detalles" 
       [class.combo-card]="esCombo(d)"
       [matTooltip]="esCombo(d) ? 'Combo de productos' : getDetalleItem(d)">
    
    <!-- Header con informaci√≥n principal -->
    <div class="card-main-content">
      <div class="product-basic-info">
        <div class="product-header">
          <strong class="product-name">
            <mat-icon class="item-icon" [class.combo-icon]="esCombo(d)">
              {{ esCombo(d) ? 'fastfood' : 'restaurant' }}
            </mat-icon>
            {{ getNombreItem(d) }}
            <span *ngIf="esCombo(d)" class="combo-badge">COMBO</span>
          </strong>
          <span class="categoria-badge" *ngIf="!esCombo(d)">
            {{ getDetalleItem(d) }}
          </span>
        </div>
        
        <div class="product-details">
          <span class="tamano-badge" *ngIf="!esCombo(d) && d.Tamano_Nombre">
            {{ d.Tamano_Nombre }}
          </span>
          <span class="price-tag">S/ {{ (d.PrecioTotal / d.Cantidad) | number:'1.2-2' }}</span>
        </div>
      </div>
      
      <div class="card-actions">
        <button mat-icon-button color="warn" class="delete-btn" 
                (click)="eliminar(d)" matTooltip="Quitar del pedido">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>

    <!-- Footer con controles y subtotal -->
    <div class="card-footer">
      <div class="subtotal-section">
        <span class="subtotal-label">Subtotal:</span>
        <span class="subtotal-value">S/ {{ d.PrecioTotal | number:'1.2-2' }}</span>
      </div>
      
      <div class="quantity-section">
        <div class="cantidad-control-horizontal">
          <button mat-mini-button class="qty-btn qty-decrease" 
                  (click)="reducirCantidad(d)" matTooltip="Reducir cantidad">
            <mat-icon>remove</mat-icon>
          </button>
          <span class="quantity-number">{{ d.Cantidad }}</span>
          <button mat-mini-button class="qty-btn qty-increase" 
                  (click)="aumentarCantidad(d)" matTooltip="Aumentar cantidad">
            <mat-icon>add</mat-icon>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Mensaje cuando no hay productos -->
  <div class="empty-state" *ngIf="detalles.length === 0">
    <mat-icon class="empty-icon">shopping_cart_off</mat-icon>
    <h3>El carrito est√° vac√≠o</h3>
    <p>Agrega productos para comenzar una venta</p>
  </div>
</div>

<!-- üîπ Total y bot√≥n -->
<div class="total-container">
  <h3 class="total-text">Total a Pagar: S/ {{ getTotal() | number:'1.2-2' }}</h3>
  <button mat-flat-button class="order-btn" 
          (click)="realizarPedido()" 
          [disabled]="detalles.length === 0">
    <mat-icon>point_of_sale</mat-icon>
    PROCESAR PAGO
  </button>
</div>