<h2 mat-dialog-title>{{ receta.receta_id ? 'Editar Receta' : 'Nueva Receta' }}</h2>

<mat-dialog-content>
  <form #form="ngForm" (ngSubmit)="saveReceta()">

    <mat-form-field appearance="fill">
      <mat-label>Nombre de la Receta</mat-label>
      <input matInput type="text" [(ngModel)]="receta.nombre_receta" name="nombre_receta" required />
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>DescripciÃ³n</mat-label>
      <textarea matInput rows="2" [(ngModel)]="receta.descripcion_receta" name="descripcion_receta" required></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Tiempo estimado (minutos)</mat-label>
      <input matInput type="number" [(ngModel)]="receta.tiempo_estimado_minutos" name="tiempo_estimado_minutos" required />
    </mat-form-field>

    <h3>ðŸ§‚ Detalles de Receta</h3>

    <div *ngFor="let det of detalles; let i = index" class="detalle-item">
      <mat-form-field appearance="outline">
        <mat-label>Ingrediente</mat-label>
        <mat-select [(ngModel)]="det.ingrediente_id" name="ingrediente_id_{{i}}" required>
          <mat-option *ngFor="let ing of ingredientes" [value]="ing.ingrediente_id">
            {{ ing.nombre_ingrediente }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Cantidad</mat-label>
        <input matInput type="number" [(ngModel)]="det.cantidad_requerida" name="cantidad_requerida_{{i}}" required />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Unidad de medida</mat-label>
        <mat-select [(ngModel)]="det.unidad_medida" name="unidad_medida_{{i}}" required>
          <mat-option value="gramos">Gramos (g)</mat-option>
          <mat-option value="kilogramos">Kilogramos (kg)</mat-option>
          <mat-option value="mililitros">Mililitros (ml)</mat-option>
          <mat-option value="litros">Litros (L)</mat-option>
          <mat-option value="unidad">Unidad</mat-option>
          <mat-option value="pizca">Pizca</mat-option>
          <mat-option value="taza">Taza</mat-option>
          <mat-option value="cucharada">Cucharada</mat-option>
          <mat-option value="cucharadita">Cucharadita</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>DescripciÃ³n de uso</mat-label>
        <input matInput type="text" [(ngModel)]="det.descripcion_uso" name="descripcion_uso_{{i}}" />
      </mat-form-field>

      <button mat-icon-button color="warn" type="button" (click)="removeDetalle(i)">
        <mat-icon>delete</mat-icon>
      </button>
    </div>

    <button mat-button type="button" color="primary" (click)="addDetalle()">
      <mat-icon>add</mat-icon> Agregar Ingrediente
    </button>

  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="close()">Cancelar</button>
  <button mat-flat-button color="primary" (click)="saveReceta()">Guardar</button>
</mat-dialog-actions>
